{% block karser_recaptcha3_widget %}
    {% filter spaceless %}
        {%- set type = type|default('hidden') -%}
        {{ block('form_widget_simple') }}

        {% if form.vars.enabled -%}
            <script type="text/javascript">
                var recaptchaCallback = function() {
                    grecaptcha.ready(function() {
                        grecaptcha.execute('{{ form.vars.site_key }}', {action: '{{ form.vars.action_name }}'}).then(function(token) {
                            document.getElementById('{{ id }}').value = token;
                        });
                    });
                };
            </script>
            <script src="https://www.google.com/recaptcha/api.js?render={{ form.vars.site_key }}&onload=recaptchaCallback" async defer></script>

        {%- endif %}
    {% endfilter %}
{% endblock %}
